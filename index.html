<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>PCC389 FAQ</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
            background: #0b1220;
            color: #e2e8f0;
            line-height: 1.6;
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #1f2937;
        }
        
        h1 { 
            color: #60a5fa;
            margin-bottom: 15px;
        }
        
        .contact-info {
            background: #0f172a;
            border: 1px solid #1f2937;
            border-radius: 10px;
            padding: 15px;
            margin: 20px 0;
        }
        
        .contact-info p {
            margin: 5px 0;
        }
        
        .faq-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .controls-right {
            display: flex;
            gap: 15px;
            align-items: center;
        }
        
        .category-filter select,
        .language-toggle {
            background: #0f172a;
            color: #e2e8f0;
            border: 1px solid #1f2937;
            padding: 8px 12px;
            border-radius: 6px;
            min-width: 180px;
        }
        
        .language-toggle {
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            min-width: 120px;
        }
        
        .language-toggle:hover {
            background: #1e293b;
        }
        
        .language-toggle:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        
        .faq-item {
            background: #0f172a;
            border: 1px solid #1f2937;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
        }
        
        .faq-item h3 {
            color: #60a5fa;
            margin-bottom: 10px;
        }
        
        .category {
            display: inline-block;
            background: #1e293b;
            color: #93c5fd;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            margin-bottom: 10px;
        }
        
        .question-form {
            background: #0f172a;
            border: 1px solid #1f2937;
            border-radius: 10px;
            padding: 25px;
            margin: 40px 0 20px 0;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            background: #0b1220;
            color: #e2e8f0;
            border: 1px solid #1f2937;
            padding: 10px 12px;
            border-radius: 6px;
            font-family: inherit;
        }
        
        .form-group textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        .submit-btn {
            background: #60a5fa;
            color: #0b1220;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
        }
        
        .submit-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: #94a3b8;
        }
        
        .error {
            background: rgba(248, 113, 113, 0.1);
            border: 1px solid #f87171;
            color: #f87171;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            margin: 15px 0;
        }
        
        .translating-indicator {
            display: inline-block;
            background: #f59e0b;
            color: #0f172a;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 10px;
            margin-left: 8px;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.6; }
            100% { opacity: 1; }
        }
    </style>
</head>
<body>
    <header>
        <h1 id="pageTitle">PCC389 FAQ</h1>
        <div class="contact-info">
            <p><strong id="officeLabel">Office:</strong> <span id="officeNumbers">905-566-1269, 905-566-1319, 647-335-0949</span></p>
            <p><strong id="addressLabel">Address:</strong> <span id="addressText">285 Enfield Pl, Mississauga, ON L5B 3Y6</span></p>
        </div>
    </header>

    <main>
        <section class="latest-faqs">
            <div class="faq-controls">
                <h2 id="questionsTitle">Questions & Answers</h2>
                <div class="controls-right">
                    <div class="category-filter">
                        <select id="categoryFilter">
                            <option value="all" id="allCategories">All Categories</option>
                            <option value="General Questions" id="generalCategory">General Questions</option>
                            <option value="Plumbing" id="plumbingCategory">Plumbing</option>
                            <option value="Electricity" id="electricityCategory">Electricity</option>
                            <option value="Heating & Cooling" id="heatingCategory">Heating & Cooling</option>
                            <option value="Fitness Center" id="fitnessCategory">Fitness Center</option>
                        </select>
                    </div>
                    <button class="language-toggle" id="languageToggle">
                        <span>ğŸŒ</span>
                        <span id="languageText">ä¸­æ–‡</span>
                    </button>
                </div>
            </div>
            <div id="faqList">
                <div class="loading" id="loadingText">Loading FAQs...</div>
            </div>
        </section>

        <div class="question-form">
            <h3 id="submitQuestionTitle">Submit a New Question</h3>
            <form id="newQuestionForm">
                <div class="form-group">
                    <label for="question" id="questionLabel">Your Question *</label>
                    <textarea id="question" name="question" required placeholder="Enter your question here..."></textarea>
                </div>
                
                <div class="form-group">
                    <label for="category" id="categoryLabel">Category</label>
                    <select id="category" name="category">
                        <option value="General Questions">General Questions</option>
                        <option value="Plumbing">Plumbing</option>
                        <option value="Electricity">Electricity</option>
                        <option value="Heating & Cooling">Heating & Cooling</option>
                        <option value="Fitness Center">Fitness Center</option>
                    </select>
                </div>
                
                <button type="submit" class="submit-btn" id="submitButton">Submit Question</button>
            </form>
        </div>
    </main>

    <script>
        // ç¿»è¯‘æ•°æ®
        const translations = {
            en: {
                pageTitle: "PCC389 FAQ",
                officeLabel: "Office:",
                addressLabel: "Address:",
                questionsTitle: "Questions & Answers",
                allCategories: "All Categories",
                generalCategory: "General Questions",
                plumbingCategory: "Plumbing",
                electricityCategory: "Electricity",
                heatingCategory: "Heating & Cooling",
                fitnessCategory: "Fitness Center",
                languageText: "ä¸­æ–‡",
                submitQuestionTitle: "Submit a New Question",
                questionLabel: "Your Question *",
                categoryLabel: "Category",
                submitButton: "Submit Question",
                questionPlaceholder: "Enter your question here...",
                loadingText: "Loading FAQs...",
                noQuestions: "No questions found in this category.",
                submitSuccess: "Question submitted! You will be redirected to GitHub.",
                enterQuestion: "Please enter a question!",
                translating: "Translating...",
                translationError: "Translation failed, showing original text"
            },
            zh: {
                pageTitle: "PCC389 å¸¸è§é—®é¢˜",
                officeLabel: "åŠå…¬å®¤:",
                addressLabel: "åœ°å€:",
                questionsTitle: "é—®é¢˜ä¸è§£ç­”",
                allCategories: "å…¨éƒ¨åˆ†ç±»",
                generalCategory: "ä¸€èˆ¬é—®é¢˜",
                plumbingCategory: "ç®¡é“",
                electricityCategory: "ç”µåŠ›",
                heatingCategory: "ä¾›æš–ä¸åˆ¶å†·",
                fitnessCategory: "å¥èº«ä¸­å¿ƒ",
                languageText: "English",
                submitQuestionTitle: "æäº¤æ–°é—®é¢˜",
                questionLabel: "æ‚¨çš„é—®é¢˜ *",
                categoryLabel: "åˆ†ç±»",
                submitButton: "æäº¤é—®é¢˜",
                questionPlaceholder: "åœ¨è¿™é‡Œè¾“å…¥æ‚¨çš„é—®é¢˜...",
                loadingText: "åŠ è½½å¸¸è§é—®é¢˜ä¸­...",
                noQuestions: "æ­¤åˆ†ç±»ä¸­æ²¡æœ‰æ‰¾åˆ°é—®é¢˜ã€‚",
                submitSuccess: "é—®é¢˜å·²æäº¤ï¼æ‚¨å°†è¢«é‡å®šå‘åˆ°GitHubã€‚",
                enterQuestion: "è¯·è¾“å…¥é—®é¢˜ï¼",
                translating: "ç¿»è¯‘ä¸­...",
                translationError: "ç¿»è¯‘å¤±è´¥ï¼Œæ˜¾ç¤ºåŸæ–‡"
            }
        };

        let currentLanguage = 'en';
        let originalFAQs = [];
        let translatedFAQs = [];

        // ä½¿ç”¨å…è´¹çš„ç¿»è¯‘API (Google Translate API ä»£ç†)
        async function translateText(text, targetLang) {
            try {
                // ä½¿ç”¨å…è´¹çš„ç¿»è¯‘API
                const response = await fetch('https://api.mymemory.translated.net/get', {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json',
                    }
                });

                const url = `https://api.mymemory.translated.net/get?q=${encodeURIComponent(text)}&langpair=en|${targetLang === 'zh' ? 'zh-CN' : 'en'}`;
                const response = await fetch(url);
                
                if (!response.ok) {
                    throw new Error('Translation API error');
                }
                
                const data = await response.json();
                
                if (data.responseStatus === 200 && data.responseData) {
                    return data.responseData.translatedText;
                } else {
                    throw new Error('Translation failed');
                }
            } catch (error) {
                console.error('Translation error:', error);
                // å¦‚æœç¿»è¯‘å¤±è´¥ï¼Œè¿”å›åŸå§‹æ–‡æœ¬
                return text;
            }
        }

        // æ‰¹é‡ç¿»è¯‘FAQå†…å®¹
        async function translateFAQs(faqs, targetLang) {
            if (targetLang === 'en') {
                return faqs; // è‹±æ–‡ä¸éœ€è¦ç¿»è¯‘
            }

            const translated = [];
            
            for (const faq of faqs) {
                try {
                    // ç¿»è¯‘ç­”æ¡ˆ
                    const translatedAnswer = await translateText(faq.answer, targetLang);
                    
                    // ç¿»è¯‘åˆ†ç±»
                    const translatedCategory = await translateText(faq.category, targetLang);
                    
                    translated.push({
                        ...faq,
                        translatedAnswer,
                        translatedCategory
                    });
                } catch (error) {
                    console.error(`Failed to translate FAQ: ${faq.question}`, error);
                    translated.push({
                        ...faq,
                        translatedAnswer: faq.answer,
                        translatedCategory: faq.category
                    });
                }
            }
            
            return translated;
        }

        // åˆ‡æ¢è¯­è¨€
        async function toggleLanguage() {
            const toggleBtn = document.getElementById('languageToggle');
            const originalText = toggleBtn.innerHTML;
            
            try {
                toggleBtn.disabled = true;
                toggleBtn.innerHTML = '<span>ğŸŒ</span><span class="translating-indicator">Translating...</span>';
                
                const targetLanguage = currentLanguage === 'en' ? 'zh' : 'en';
                
                if (targetLanguage === 'zh' && translatedFAQs.length === 0) {
                    // é¦–æ¬¡ç¿»è¯‘
                    translatedFAQs = await translateFAQs(originalFAQs, 'zh');
                }
                
                currentLanguage = targetLanguage;
                applyTranslations();
                displayFAQs(currentLanguage === 'en' ? originalFAQs : translatedFAQs);
                
            } catch (error) {
                console.error('Language toggle error:', error);
                const t = translations[currentLanguage];
                showError(t.translationError);
            } finally {
                toggleBtn.disabled = false;
                toggleBtn.innerHTML = originalText;
            }
        }

        // åº”ç”¨ç¿»è¯‘
        function applyTranslations() {
            const t = translations[currentLanguage];
            
            // æ›´æ–°æ‰€æœ‰æ–‡æœ¬å…ƒç´ 
            document.getElementById('pageTitle').textContent = t.pageTitle;
            document.getElementById('officeLabel').textContent = t.officeLabel;
            document.getElementById('addressLabel').textContent = t.addressLabel;
            document.getElementById('questionsTitle').textContent = t.questionsTitle;
            document.getElementById('allCategories').textContent = t.allCategories;
            document.getElementById('generalCategory').textContent = t.generalCategory;
            document.getElementById('plumbingCategory').textContent = t.plumbingCategory;
            document.getElementById('electricityCategory').textContent = t.electricityCategory;
            document.getElementById('heatingCategory').textContent = t.heatingCategory;
            document.getElementById('fitnessCategory').textContent = t.fitnessCategory;
            document.getElementById('languageText').textContent = t.languageText;
            document.getElementById('submitQuestionTitle').textContent = t.submitQuestionTitle;
            document.getElementById('questionLabel').textContent = t.questionLabel;
            document.getElementById('categoryLabel').textContent = t.categoryLabel;
            document.getElementById('submitButton').textContent = t.submitButton;
            document.getElementById('question').placeholder = t.questionPlaceholder;
            document.getElementById('loadingText').textContent = t.loadingText;
        }

        // åŠ è½½FAQæ•°æ®
        async function loadFAQs() {
            try {
                console.log('Loading FAQs...');
                
                const response = await fetch('faq.json');
                if (!response.ok) {
                    throw new Error(`Failed to load FAQ file: ${response.status}`);
                }
                
                const data = await response.json();
                console.log('Loaded data:', data);
                
                if (!data.faqs) {
                    throw new Error('FAQ data is missing "faqs" array');
                }
                
                originalFAQs = data.faqs;
                translatedFAQs = []; // é‡ç½®ç¿»è¯‘ç¼“å­˜
                displayFAQs(originalFAQs);
                
            } catch (error) {
                console.error('Error:', error);
                showError(error.message);
            }
        }

        function displayFAQs(faqs, category = 'all') {
            const faqList = document.getElementById('faqList');
            const t = translations[currentLanguage];
            
            let filteredFAQs = category === 'all' 
                ? faqs 
                : faqs.filter(faq => {
                    const faqCategory = currentLanguage === 'zh' && faq.translatedCategory ? faq.translatedCategory : faq.category;
                    return faqCategory === category;
                });
            
            if (filteredFAQs.length === 0) {
                faqList.innerHTML = `<div class="error">${t.noQuestions}</div>`;
                return;
            }
            
            faqList.innerHTML = filteredFAQs.map(faq => {
                // æ ¹æ®å½“å‰è¯­è¨€é€‰æ‹©æ˜¾ç¤ºçš„ç­”æ¡ˆå’Œåˆ†ç±»
                const answer = currentLanguage === 'zh' && faq.translatedAnswer ? faq.translatedAnswer : faq.answer;
                const displayCategory = currentLanguage === 'zh' && faq.translatedCategory ? faq.translatedCategory : faq.category;
                
                return `
                <div class="faq-item">
                    <span class="category">${displayCategory}</span>
                    <h3>${faq.question}</h3>
                    <div class="answer">${answer}</div>
                    <small style="color: #94a3b8;">Updated: ${faq.last_updated}</small>
                </div>
                `;
            }).join('');
        }

        function showError(message) {
            document.getElementById('faqList').innerHTML = `
                <div class="error">
                    <strong>Error:</strong> ${message}<br>
                    <small>Check browser console for details.</small>
                </div>
            `;
        }

        // è¡¨å•æäº¤
        document.getElementById('newQuestionForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const t = translations[currentLanguage];
            const question = document.getElementById('question').value;
            const category = document.getElementById('category').value;
            
            if (!question.trim()) {
                alert(t.enterQuestion);
                return;
            }
            
            // åˆ›å»ºGitHub Issueé“¾æ¥
            const issueTitle = `FAQ: ${question.substring(0, 50)}${question.length > 50 ? '...' : ''}`;
            const issueBody = `**Question:** ${question}\n\n**Category:** ${category}\n\n**Language:** ${currentLanguage}\n\n**Submitted:** ${new Date().toLocaleString()}`;
            
            // æ›¿æ¢æˆä½ çš„å®é™…GitHubä»“åº“URL
            const githubUrl = `https://github.com/YOUR_USERNAME/YOUR_REPO/issues/new?title=${encodeURIComponent(issueTitle)}&body=${encodeURIComponent(issueBody)}&labels=faq`;
            
            window.open(githubUrl, '_blank');
            alert(t.submitSuccess);
            
            // æ¸…ç©ºè¡¨å•
            this.reset();
        });

        // åˆ†ç±»ç­›é€‰
        document.getElementById('categoryFilter').addEventListener('change', function(e) {
            const faqsToDisplay = currentLanguage === 'en' ? originalFAQs : translatedFAQs;
            displayFAQs(faqsToDisplay, e.target.value);
        });

        // è¯­è¨€åˆ‡æ¢
        document.getElementById('languageToggle').addEventListener('click', toggleLanguage);

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            applyTranslations();
            loadFAQs();
        });
    </script>
</body>
</html>
