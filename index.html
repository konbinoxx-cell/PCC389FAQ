<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <title>PCC389 FAQ</title>
  <style>
    body{font-family:system-ui;background:#0b1220;color:#e2e8f0;margin:0;padding:2rem}
    h1{color:#60a5fa}button{background:#60a5fa;color:#0b1220;border:none;padding:.5rem 1rem;border-radius:4px;cursor:pointer}
    textarea{width:100%;min-height:100px}
  </style>
</head>
<body>
  <h1>PCC389 FAQ</h1>
  <div id="list">Loading…</div>

  <h2>Submit a new question</h2>
  <form id="form">
    <textarea id="q" placeholder="Question" required></textarea><br/>
    <select id="c">
      <option>General Questions</option><option>Plumbing</option><option>Fitness Center</option>
    </select><br/><br/>
    <button type="submit">Submit</button>
  </form>

  <script>
    // ?? faq.json
    fetch('./faq.json').then(r=>r.json()).then(render);

    function render(list){
      document.getElementById('list').innerHTML = list.map(f=>`
        <div style="border:1px solid #1f2937;padding:1rem;margin-bottom:1rem">
          <strong>${f.category}</strong><br/>
          <div>${f.question}</div>
          <div style="color:#94a3b8">${f.answer}</div>
        </div>`).join('');
    }

    // ?????:??? GitHub Issue
    document.getElementById('form').addEventListener('submit',async e=>{
      e.preventDefault();
      const question = document.getElementById('q').value;
      const category = document.getElementById('c').value;
      const pat = prompt('GitHub PAT(????)');
      await fetch(`https://api.github.com/repos/${location.pathname.split('/')[1]}/${location.pathname.split('/')[2]}/issues`,{
        method:'POST',
        headers:{
          'Accept':'application/vnd.github+json',
          'Authorization':`Bearer ${pat}`,
          'Content-Type':'application/json'
        },
        body:JSON.stringify({
          title:`[FAQ] ${category}`,
          body:`Question:\n${question}\n\nCategory:${category}`,
          labels:['faq']
        })
      });
      alert('???!?????????');
      q.value='';
    });
  </script>
</body>
</html>
