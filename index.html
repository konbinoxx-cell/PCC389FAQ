<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>PCC389 FAQ</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
            background: #0b1220;
            color: #e2e8f0;
            line-height: 1.6;
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #1f2937;
        }
        
        h1 { 
            color: #60a5fa;
            margin-bottom: 15px;
        }
        
        .contact-info {
            background: #0f172a;
            border: 1px solid #1f2937;
            border-radius: 10px;
            padding: 15px;
            margin: 20px 0;
        }
        
        .contact-info p {
            margin: 5px 0;
        }
        
        .faq-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .category-filter select {
            background: #0f172a;
            color: #e2e8f0;
            border: 1px solid #1f2937;
            padding: 8px 12px;
            border-radius: 6px;
            min-width: 180px;
        }
        
        .faq-item {
            background: #0f172a;
            border: 1px solid #1f2937;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
        }
        
        .faq-item h3 {
            color: #60a5fa;
            margin-bottom: 10px;
        }
        
        .category {
            display: inline-block;
            background: #1e293b;
            color: #93c5fd;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            margin-bottom: 10px;
        }
        
        .question-form {
            background: #0f172a;
            border: 1px solid #1f2937;
            border-radius: 10px;
            padding: 25px;
            margin: 40px 0 20px 0;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            background: #0b1220;
            color: #e2e8f0;
            border: 1px solid #1f2937;
            padding: 10px 12px;
            border-radius: 6px;
            font-family: inherit;
        }
        
        .form-group textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        .submit-btn {
            background: #60a5fa;
            color: #0b1220;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: #94a3b8;
        }
        
        .error {
            background: rgba(248, 113, 113, 0.1);
            border: 1px solid #f87171;
            color: #f87171;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            margin: 15px 0;
        }
    </style>
</head>
<body>
    <header>
        <h1>PCC389 FAQ</h1>
        <div class="contact-info">
            <p><strong>Office:</strong> 905-566-1269, 905-566-1319, 647-335-0949</p>
            <p><strong>Address:</strong> 285 Enfield Pl, Mississauga, ON L5B 3Y6</p>
        </div>
    </header>

    <main>
        <section class="latest-faqs">
            <div class="faq-controls">
                <h2>Questions & Answers</h2>
                <div class="category-filter">
                    <select id="categoryFilter">
                        <option value="all">All Categories</option>
                        <option value="General Questions">General Questions</option>
                        <option value="Plumbing">Plumbing</option>
                        <option value="Electricity">Electricity</option>
                        <option value="Heating & Cooling">Heating & Cooling</option>
                        <option value="Fitness Center">Fitness Center</option>
                    </select>
                </div>
            </div>
            <div id="faqList">
                <div class="loading">Loading FAQs...</div>
            </div>
        </section>

        <div class="question-form">
            <h3>Submit a New Question</h3>
            <form id="newQuestionForm">
                <div class="form-group">
                    <label for="question">Your Question *</label>
                    <textarea id="question" name="question" required placeholder="Enter your question here..."></textarea>
                </div>
                
                <div class="form-group">
                    <label for="category">Category</label>
                    <select id="category" name="category">
                        <option value="General Questions">General Questions</option>
                        <option value="Plumbing">Plumbing</option>
                        <option value="Electricity">Electricity</option>
                        <option value="Heating & Cooling">Heating & Cooling</option>
                        <option value="Fitness Center">Fitness Center</option>
                    </select>
                </div>
                
                <button type="submit" class="submit-btn">Submit Question</button>
            </form>
        </div>
    </main>

    <script>
        // 简单可靠的FAQ加载
        async function loadFAQs() {
            try {
                console.log('Loading FAQs...');
                
                const response = await fetch('faq.json');
                if (!response.ok) {
                    throw new Error(`Failed to load FAQ file: ${response.status}`);
                }
                
                const data = await response.json();
                console.log('Loaded data:', data);
                
                if (!data.faqs) {
                    throw new Error('FAQ data is missing "faqs" array');
                }
                
                displayFAQs(data.faqs);
                
            } catch (error) {
                console.error('Error:', error);
                showError(error.message);
            }
        }

        function displayFAQs(faqs, category = 'all') {
            const faqList = document.getElementById('faqList');
            
            let filteredFAQs = category === 'all' 
                ? faqs 
                : faqs.filter(faq => faq.category === category);
            
            if (filteredFAQs.length === 0) {
                faqList.innerHTML = '<div class="error">No questions found in this category.</div>';
                return;
            }
            
            faqList.innerHTML = filteredFAQs.map(faq => `
                <div class="faq-item">
                    <span class="category">${faq.category}</span>
                    <h3>${faq.question}</h3>
                    <div class="answer">${faq.answer}</div>
                    <small style="color: #94a3b8;">Updated: ${faq.last_updated}</small>
                </div>
            `).join('');
        }

        function showError(message) {
            document.getElementById('faqList').innerHTML = `
                <div class="error">
                    <strong>Error:</strong> ${message}<br>
                    <small>Check browser console for details.</small>
                </div>
            `;
        }

        // 表单提交
        document.getElementById('newQuestionForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const question = document.getElementById('question').value;
            const category = document.getElementById('category').value;
            
            if (!question.trim()) {
                alert('Please enter a question!');
                return;
            }
            
            // 创建GitHub Issue链接
            const issueTitle = `FAQ: ${question.substring(0, 50)}${question.length > 50 ? '...' : ''}`;
            const issueBody = `**Question:** ${question}\n\n**Category:** ${category}\n\n**Submitted:** ${new Date().toLocaleString()}`;
            
            const githubUrl = `https://github.com/YOUR_USERNAME/YOUR_REPO/issues/new?title=${encodeURIComponent(issueTitle)}&body=${encodeURIComponent(issueBody)}&labels=faq`;
            
            window.open(githubUrl, '_blank');
            alert('Question submitted! You will be redirected to GitHub.');
            
            // 清空表单
            this.reset();
        });

        // 分类筛选
        document.getElementById('categoryFilter').addEventListener('change', async function(e) {
            try {
                const response = await fetch('faq.json');
                const data = await response.json();
                displayFAQs(data.faqs, e.target.value);
            } catch (error) {
                showError('Failed to filter FAQs');
            }
        });

        // 初始化
        document.addEventListener('DOMContentLoaded', loadFAQs);
    </script>
</body>
</html>
