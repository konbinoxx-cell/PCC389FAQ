<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>PCC389 FAQ</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
            background: #0b1220;
            color: #e2e8f0;
            line-height: 1.6;
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #1f2937;
        }
        
        h1 { 
            color: #60a5fa;
            margin-bottom: 15px;
        }
        
        .contact-info {
            background: #0f172a;
            border: 1px solid #1f2937;
            border-radius: 10px;
            padding: 15px;
            margin: 20px 0;
        }
        
        .contact-info p {
            margin: 5px 0;
        }
        
        .faq-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .controls-right {
            display: flex;
            gap: 15px;
            align-items: center;
        }
        
        .category-filter select,
        .language-toggle {
            background: #0f172a;
            color: #e2e8f0;
            border: 1px solid #1f2937;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 14px;
        }
        
        .category-filter select {
            min-width: 180px;
        }
        
        .language-toggle {
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            min-width: 100px;
            transition: background-color 0.2s;
        }
        
        .language-toggle:hover {
            background: #1e293b;
        }
        
        .language-toggle:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        
        .faq-item {
            background: #0f172a;
            border: 1px solid #1f2937;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
        }
        
        .faq-item h3 {
            color: #60a5fa;
            margin-bottom: 10px;
        }
        
        .category {
            display: inline-block;
            background: #1e293b;
            color: #93c5fd;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            margin-bottom: 10px;
        }
        
        .question-form {
            background: #0f172a;
            border: 1px solid #1f2937;
            border-radius: 10px;
            padding: 25px;
            margin: 40px 0 20px 0;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            background: #0b1220;
            color: #e2e8f0;
            border: 1px solid #1f2937;
            padding: 10px 12px;
            border-radius: 6px;
            font-family: inherit;
            font-size: 14px;
        }
        
        .form-group textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        .submit-btn {
            background: #60a5fa;
            color: #0b1220;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            font-size: 14px;
        }
        
        .submit-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: #94a3b8;
            font-size: 16px;
        }
        
        .error {
            background: rgba(248, 113, 113, 0.1);
            border: 1px solid #f87171;
            color: #f87171;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            margin: 15px 0;
        }
        
        .translating-indicator {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            background: #f59e0b;
            color: #0f172a;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 10px;
        }
        
        .translating-dots {
            display: inline-flex;
            gap: 2px;
        }
        
        .translating-dots span {
            width: 4px;
            height: 4px;
            border-radius: 50%;
            background: #0f172a;
            animation: bounce 1.4s infinite ease-in-out both;
        }
        
        .translating-dots span:nth-child(1) { animation-delay: -0.32s; }
        .translating-dots span:nth-child(2) { animation-delay: -0.16s; }
        
        @keyframes bounce {
            0%, 80%, 100% { 
                transform: scale(0);
            } 
            40% { 
                transform: scale(1.0);
            }
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 600px) {
            .faq-controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            .controls-right {
                justify-content: space-between;
            }
            
            .category-filter select,
            .language-toggle {
                flex: 1;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1 id="pageTitle">PCC389 FAQ</h1>
        <div class="contact-info">
            <p><strong id="officeLabel">Office:</strong> <span id="officeNumbers">905-566-1269, 905-566-1319, 647-335-0949</span></p>
            <p><strong id="addressLabel">Address:</strong> <span id="addressText">285 Enfield Pl, Mississauga, ON L5B 3Y6</span></p>
        </div>
    </header>

    <main>
        <section class="latest-faqs">
            <div class="faq-controls">
                <h2 id="questionsTitle">Questions & Answers</h2>
                <div class="controls-right">
                    <div class="category-filter">
                        <select id="categoryFilter">
                            <option value="all" id="allCategories">All Categories</option>
                            <option value="General Questions" id="generalCategory">General Questions</option>
                            <option value="Plumbing" id="plumbingCategory">Plumbing</option>
                            <option value="Electricity" id="electricityCategory">Electricity</option>
                            <option value="Heating & Cooling" id="heatingCategory">Heating & Cooling</option>
                            <option value="Fitness Center" id="fitnessCategory">Fitness Center</option>
                        </select>
                    </div>
                    <button class="language-toggle" id="languageToggle">
                        <span>ğŸŒ</span>
                        <span id="languageText">ä¸­æ–‡</span>
                    </button>
                </div>
            </div>
            <div id="faqList">
                <div class="loading" id="loadingText">Loading FAQs...</div>
            </div>
        </section>

        <div class="question-form">
            <h3 id="submitQuestionTitle">Submit a New Question</h3>
            <form id="newQuestionForm">
                <div class="form-group">
                    <label for="question" id="questionLabel">Your Question *</label>
                    <textarea id="question" name="question" required placeholder="Enter your question here..."></textarea>
                </div>
                
                <div class="form-group">
                    <label for="category" id="categoryLabel">Category</label>
                    <select id="category" name="category">
                        <option value="General Questions">General Questions</option>
                        <option value="Plumbing">Plumbing</option>
                        <option value="Electricity">Electricity</option>
                        <option value="Heating & Cooling">Heating & Cooling</option>
                        <option value="Fitness Center">Fitness Center</option>
                    </select>
                </div>
                
                <button type="submit" class="submit-btn" id="submitButton">Submit Question</button>
            </form>
        </div>
    </main>

    <script>
        // ç¿»è¯‘æ•°æ®
        const translations = {
            en: {
                pageTitle: "PCC389 FAQ",
                officeLabel: "Office:",
                addressLabel: "Address:",
                questionsTitle: "Questions & Answers",
                allCategories: "All Categories",
                generalCategory: "General Questions",
                plumbingCategory: "Plumbing",
                electricityCategory: "Electricity",
                heatingCategory: "Heating & Cooling",
                fitnessCategory: "Fitness Center",
                languageText: "ä¸­æ–‡",
                submitQuestionTitle: "Submit a New Question",
                questionLabel: "Your Question *",
                categoryLabel: "Category",
                submitButton: "Submit Question",
                questionPlaceholder: "Enter your question here...",
                loadingText: "Loading FAQs...",
                noQuestions: "No questions found in this category.",
                submitSuccess: "Question submitted! You will be redirected to GitHub.",
                enterQuestion: "Please enter a question!",
                translating: "Translating"
            },
            zh: {
                pageTitle: "PCC389 å¸¸è§é—®é¢˜",
                officeLabel: "åŠå…¬å®¤:",
                addressLabel: "åœ°å€:",
                questionsTitle: "é—®é¢˜ä¸è§£ç­”",
                allCategories: "å…¨éƒ¨åˆ†ç±»",
                generalCategory: "ä¸€èˆ¬é—®é¢˜",
                plumbingCategory: "ç®¡é“",
                electricityCategory: "ç”µåŠ›",
                heatingCategory: "ä¾›æš–ä¸åˆ¶å†·",
                fitnessCategory: "å¥èº«ä¸­å¿ƒ",
                languageText: "English",
                submitQuestionTitle: "æäº¤æ–°é—®é¢˜",
                questionLabel: "æ‚¨çš„é—®é¢˜ *",
                categoryLabel: "åˆ†ç±»",
                submitButton: "æäº¤é—®é¢˜",
                questionPlaceholder: "åœ¨è¿™é‡Œè¾“å…¥æ‚¨çš„é—®é¢˜...",
                loadingText: "åŠ è½½å¸¸è§é—®é¢˜ä¸­...",
                noQuestions: "æ­¤åˆ†ç±»ä¸­æ²¡æœ‰æ‰¾åˆ°é—®é¢˜ã€‚",
                submitSuccess: "é—®é¢˜å·²æäº¤ï¼æ‚¨å°†è¢«é‡å®šå‘åˆ°GitHubã€‚",
                enterQuestion: "è¯·è¾“å…¥é—®é¢˜ï¼",
                translating: "ç¿»è¯‘ä¸­"
            }
        };

        let currentLanguage = 'en';
        let originalFAQs = [];
        let translatedFAQs = [];

        // æ”¹è¿›çš„ç¿»è¯‘å‡½æ•° - ä½¿ç”¨æ›´å¯é çš„å…è´¹API
        async function translateText(text, targetLang) {
            try {
                // ä½¿ç”¨ LibreTranslate å…è´¹API
                const response = await fetch('https://libretranslate.de/translate', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        q: text,
                        source: 'en',
                        target: targetLang === 'zh' ? 'zh' : 'en',
                        format: 'text'
                    })
                });

                if (!response.ok) {
                    throw new Error('Translation API error');
                }
                
                const data = await response.json();
                
                if (data.translatedText) {
                    return data.translatedText;
                } else {
                    throw new Error('Translation failed');
                }
            } catch (error) {
                console.error('Translation error:', error);
                // å¦‚æœç¿»è¯‘å¤±è´¥ï¼Œä½¿ç”¨ç®€å•çš„å†…ç½®è¯å…¸
                return simpleTranslate(text, targetLang);
            }
        }

        // ç®€å•çš„å†…ç½®ç¿»è¯‘è¯å…¸ä½œä¸ºå¤‡ç”¨
        function simpleTranslate(text, targetLang) {
            if (targetLang !== 'zh') return text;
            
            const dictionary = {
                // åˆ†ç±»
                "General Questions": "ä¸€èˆ¬é—®é¢˜",
                "Plumbing": "ç®¡é“",
                "Electricity": "ç”µåŠ›", 
                "Heating & Cooling": "ä¾›æš–ä¸åˆ¶å†·",
                "Fitness Center": "å¥èº«ä¸­å¿ƒ",
                
                // å¸¸è§å›ç­”
                "You can report maintenance issues by calling our office or submitting a request through the online portal.": 
                    "æ‚¨å¯ä»¥é€šè¿‡è‡´ç”µåŠå…¬å®¤æˆ–é€šè¿‡åœ¨çº¿é—¨æˆ·æäº¤è¯·æ±‚æ¥æŠ¥å‘Šç»´æŠ¤é—®é¢˜ã€‚",
                "The fitness center is open from 5:00 AM to 11:00 PM daily.": 
                    "å¥èº«ä¸­å¿ƒæ¯å¤©ä»æ—©ä¸Š5ç‚¹å¼€æ”¾åˆ°æ™šä¸Š11ç‚¹ã€‚",
                "For urgent plumbing issues, please call our emergency line at 647-335-0949.": 
                    "å¯¹äºç´§æ€¥ç®¡é“é—®é¢˜ï¼Œè¯·æ‹¨æ‰“æˆ‘ä»¬çš„ç´§æ€¥çƒ­çº¿647-335-0949ã€‚",
                "Please contact the building management during office hours for electrical issues.":
                    "è¯·åœ¨åŠå…¬æ—¶é—´å†…è”ç³»å¤§æ¥¼ç®¡ç†å¤„å¤„ç†ç”µåŠ›é—®é¢˜ã€‚",
                "The heating system is centrally controlled. For temperature adjustments, please contact the front desk.":
                    "ä¾›æš–ç³»ç»Ÿæ˜¯é›†ä¸­æ§åˆ¶çš„ã€‚å¦‚éœ€è°ƒèŠ‚æ¸©åº¦ï¼Œè¯·è”ç³»å‰å°ã€‚"
            };
            
            return dictionary[text] || text;
        }

        // æ‰¹é‡ç¿»è¯‘FAQå†…å®¹
        async function translateFAQs(faqs, targetLang) {
            if (targetLang === 'en') {
                return faqs; // è‹±æ–‡ä¸éœ€è¦ç¿»è¯‘
            }

            const translated = [];
            
            for (const faq of faqs) {
                try {
                    // ç¿»è¯‘ç­”æ¡ˆ
                    const translatedAnswer = await translateText(faq.answer, targetLang);
                    
                    // ç¿»è¯‘åˆ†ç±»
                    const translatedCategory = await translateText(faq.category, targetLang);
                    
                    translated.push({
                        ...faq,
                        translatedAnswer,
                        translatedCategory
                    });
                } catch (error) {
                    console.error(`Failed to translate FAQ: ${faq.question}`, error);
                    // å¦‚æœç¿»è¯‘å¤±è´¥ï¼Œä½¿ç”¨å†…ç½®è¯å…¸
                    translated.push({
                        ...faq,
                        translatedAnswer: simpleTranslate(faq.answer, targetLang),
                        translatedCategory: simpleTranslate(faq.category, targetLang)
                    });
                }
            }
            
            return translated;
        }

        // åˆ‡æ¢è¯­è¨€
        async function toggleLanguage() {
            const toggleBtn = document.getElementById('languageToggle');
            const originalText = toggleBtn.innerHTML;
            
            try {
                toggleBtn.disabled = true;
                const t = translations[currentLanguage];
                toggleBtn.innerHTML = `
                    <span>ğŸŒ</span>
                    <span class="translating-indicator">
                        ${t.translating}
                        <div class="translating-dots">
                            <span></span>
                            <span></span>
                            <span></span>
                        </div>
                    </span>
                `;
                
                const targetLanguage = currentLanguage === 'en' ? 'zh' : 'en';
                
                if (targetLanguage === 'zh' && translatedFAQs.length === 0) {
                    // é¦–æ¬¡ç¿»è¯‘
                    translatedFAQs = await translateFAQs(originalFAQs, 'zh');
                }
                
                currentLanguage = targetLanguage;
                applyTranslations();
                
                // æ˜¾ç¤ºç¿»è¯‘åçš„å†…å®¹
                const selectedCategory = document.getElementById('categoryFilter').value;
                const faqsToDisplay = currentLanguage === 'en' ? originalFAQs : translatedFAQs;
                displayFAQs(faqsToDisplay, selectedCategory);
                
            } catch (error) {
                console.error('Language toggle error:', error);
                // å‡ºé”™æ—¶ä»ç„¶åˆ‡æ¢ç•Œé¢è¯­è¨€ï¼Œä½†ä½¿ç”¨å†…ç½®ç¿»è¯‘
                currentLanguage = currentLanguage === 'en' ? 'zh' : 'en';
                applyTranslations();
                
                // ä½¿ç”¨å†…ç½®è¯å…¸çš„ç¿»è¯‘
                if (currentLanguage === 'zh' && translatedFAQs.length === 0) {
                    translatedFAQs = originalFAQs.map(faq => ({
                        ...faq,
                        translatedAnswer: simpleTranslate(faq.answer, 'zh'),
                        translatedCategory: simpleTranslate(faq.category, 'zh')
                    }));
                }
                
                const selectedCategory = document.getElementById('categoryFilter').value;
                const faqsToDisplay = currentLanguage === 'en' ? originalFAQs : translatedFAQs;
                displayFAQs(faqsToDisplay, selectedCategory);
                
                alert('éƒ¨åˆ†ç¿»è¯‘å¯èƒ½ä¸å®Œæ•´ï¼Œä½†ç•Œé¢å·²åˆ‡æ¢ä¸ºä¸­æ–‡ã€‚');
            } finally {
                toggleBtn.disabled = false;
                applyTranslations(); // é‡æ–°åº”ç”¨æ­£ç¡®çš„æŒ‰é’®æ–‡æœ¬
            }
        }

        // åº”ç”¨ç¿»è¯‘
        function applyTranslations() {
            const t = translations[currentLanguage];
            
            // æ›´æ–°æ‰€æœ‰æ–‡æœ¬å…ƒç´ 
            document.getElementById('pageTitle').textContent = t.pageTitle;
            document.getElementById('officeLabel').textContent = t.officeLabel;
            document.getElementById('addressLabel').textContent = t.addressLabel;
            document.getElementById('questionsTitle').textContent = t.questionsTitle;
            document.getElementById('allCategories').textContent = t.allCategories;
            document.getElementById('generalCategory').textContent = t.generalCategory;
            document.getElementById('plumbingCategory').textContent = t.plumbingCategory;
            document.getElementById('electricityCategory').textContent = t.electricityCategory;
            document.getElementById('heatingCategory').textContent = t.heatingCategory;
            document.getElementById('fitnessCategory').textContent = t.fitnessCategory;
            document.getElementById('languageText').textContent = t.languageText;
            document.getElementById('submitQuestionTitle').textContent = t.submitQuestionTitle;
            document.getElementById('questionLabel').textContent = t.questionLabel;
            document.getElementById('categoryLabel').textContent = t.categoryLabel;
            document.getElementById('submitButton').textContent = t.submitButton;
            document.getElementById('question').placeholder = t.questionPlaceholder;
            document.getElementById('loadingText').textContent = t.loadingText;
        }

        // åŠ è½½FAQæ•°æ®
        async function loadFAQs() {
            try {
                // å…ˆå°è¯•ä»faq.jsonåŠ è½½
                const response = await fetch('faq.json');
                if (response.ok) {
                    const data = await response.json();
                    originalFAQs = data.faqs || [];
                } else {
                    throw new Error('FAQ file not found');
                }
            } catch (error) {
                console.log('Using sample FAQs:', error);
                // å¦‚æœåŠ è½½å¤±è´¥ï¼Œä½¿ç”¨ç¤ºä¾‹æ•°æ®
                originalFAQs = [
                    {
                        "question": "How do I report a maintenance issue?",
                        "answer": "You can report maintenance issues by calling our office or submitting a request through the online portal.",
                        "category": "General Questions",
                        "last_updated": "2024-01-15"
                    },
                    {
                        "question": "What are the fitness center hours?",
                        "answer": "The fitness center is open from 5:00 AM to 11:00 PM daily.",
                        "category": "Fitness Center",
                        "last_updated": "2024-01-10"
                    },
                    {
                        "question": "Who should I contact for urgent plumbing issues?",
                        "answer": "For urgent plumbing issues, please call our emergency line at 647-335-0949.",
                        "category": "Plumbing",
                        "last_updated": "2024-01-12"
                    },
                    {
                        "question": "How do I report electrical problems?",
                        "answer": "Please contact the building management during office hours for electrical issues.",
                        "category": "Electricity",
                        "last_updated": "2024-01-08"
                    },
                    {
                        "question": "How is the heating system controlled?",
                        "answer": "The heating system is centrally controlled. For temperature adjustments, please contact the front desk.",
                        "category": "Heating & Cooling",
                        "last_updated": "2024-01-05"
                    }
                ];
            }
            
            translatedFAQs = []; // é‡ç½®ç¿»è¯‘ç¼“å­˜
            
            const selectedCategory = document.getElementById('categoryFilter').value;
            displayFAQs(originalFAQs, selectedCategory);
        }

        function displayFAQs(faqs, category = 'all') {
            const faqList = document.getElementById('faqList');
            const t = translations[currentLanguage];
            
            let filteredFAQs = category === 'all' 
                ? faqs 
                : faqs.filter(faq => {
                    const faqCategory = currentLanguage === 'zh' && faq.translatedCategory ? faq.translatedCategory : faq.category;
                    return faqCategory === category;
                });
            
            if (filteredFAQs.length === 0) {
                faqList.innerHTML = `<div class="error">${t.noQuestions}</div>`;
                return;
            }
            
            faqList.innerHTML = filteredFAQs.map(faq => {
                // æ ¹æ®å½“å‰è¯­è¨€é€‰æ‹©æ˜¾ç¤ºçš„ç­”æ¡ˆå’Œåˆ†ç±»
                const answer = currentLanguage === 'zh' && faq.translatedAnswer ? faq.translatedAnswer : faq.answer;
                const displayCategory = currentLanguage === 'zh' && faq.translatedCategory ? faq.translatedCategory : faq.category;
                
                return `
                <div class="faq-item">
                    <span class="category">${displayCategory}</span>
                    <h3>${faq.question}</h3>
                    <div class="answer">${answer}</div>
                    <small style="color: #94a3b8;">Updated: ${faq.last_updated}</small>
                </div>
                `;
            }).join('');
        }

        function showError(message) {
            document.getElementById('faqList').innerHTML = `
                <div class="error">
                    <strong>Error:</strong> ${message}
                </div>
            `;
        }

        // è¡¨å•æäº¤
        document.getElementById('newQuestionForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const t = translations[currentLanguage];
            const question = document.getElementById('question').value;
            const category = document.getElementById('category').value;
            
            if (!question.trim()) {
                alert(t.enterQuestion);
                return;
            }
            
            // åˆ›å»ºGitHub Issueé“¾æ¥
            const issueTitle = `FAQ: ${question.substring(0, 50)}${question.length > 50 ? '...' : ''}`;
            const issueBody = `**Question:** ${question}\n\n**Category:** ${category}\n\n**Language:** ${currentLanguage}\n\n**Submitted:** ${new Date().toLocaleString()}`;
            
            // æ›¿æ¢æˆä½ çš„å®é™…GitHubä»“åº“URL
            const githubUrl = `https://github.com/YOUR_USERNAME/YOUR_REPO/issues/new?title=${encodeURIComponent(issueTitle)}&body=${encodeURIComponent(issueBody)}&labels=faq`;
            
            window.open(githubUrl, '_blank');
            alert(t.submitSuccess);
            
            // æ¸…ç©ºè¡¨å•
            this.reset();
        });

        // åˆ†ç±»ç­›é€‰
        document.getElementById('categoryFilter').addEventListener('change', function(e) {
            const faqsToDisplay = currentLanguage === 'en' ? originalFAQs : translatedFAQs;
            displayFAQs(faqsToDisplay, e.target.value);
        });

        // è¯­è¨€åˆ‡æ¢
        document.getElementById('languageToggle').addEventListener('click', toggleLanguage);

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            applyTranslations();
            loadFAQs();
        });
    </script>
</body>
</html>
